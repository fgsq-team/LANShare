<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"/>
    <title>LANShare</title>
    <link rel="icon" href="favicon.ico" type="image/ico">
    <meta name="keywords" content="LANShare">
    <meta name="description" content="LANShare">
    <meta name="author" content="fgsq">
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/style.min.css" rel="stylesheet">
    <link href="css/lanshare.css" rel="stylesheet">
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, minimum-scale=0.5, maximum-scale=2.0, user-scalable=yes"/>

</head>

<body>
<div class="lyear-layout-web">
    <div class="lyear-layout-container">
        <!--左侧导航-->
        <aside class="lyear-layout-sidebar">
            <!-- logo -->
            <div id="logo" class="sidebar-header">
                <a href="/"><img src="images/lanshare.png" title="LANShare" alt="LANShare"/></a>
            </div>
            <div class="lyear-layout-sidebar-scroll">
                <nav class="sidebar-main">
                    <ul class="nav nav-drawer">
                        <li class="nav-item active nav-item-serach"><a><i style=""></i>搜索</a></li>
                        <li class="nav-item active nav-item-apps"><a><i class=""></i>软件</a></li>
                        <li class="nav-item active nav-item-media"><a><i class=""></i>媒体</a></li>
                        <li class="nav-item active nav-item-files"><a><i class=""></i>文件管理</a>
                        </li>
                    </ul>
                </nav>
            </div>
        </aside>
        <!--左侧导航end-->

        <!--头部信息-->
        <header class="lyear-layout-header">
            <nav class="navbar navbar-default">
                <div class="topbar">
                    <div class="topbar-left">
                        <div class="lyear-aside-toggler">
                            <span class="lyear-toggler-bar"></span>
                            <span class="lyear-toggler-bar"></span>
                            <span class="lyear-toggler-bar"></span>
                        </div>
                    </div>
                    <ul class="topbar-right">
                        <li class="dropdown dropdown-skin">

                        </li>
                    </ul>
                </div>
            </nav>
        </header>
        <!--头部信息end-->

        <!--主要视图-->
        <main class="lyear-layout-content">
            <div class="container-fluid">
                <!--文件列表-->
                <div class="row file-list-div" style="display: none">
                    <div class="col-lg-12">
                        <div class="card">
                            <div class="card-header">
                                <h4>文件列表</h4>
                            </div>
                            <div class="path-text">
                                /
                            </div>
                            <div class="card-body">
                                <div class="filelist">
                                    <div class="bottom-list">
                                        <div class="file-item">
                                            <div class="file-item-icon file-item-base"></div>
                                            <div class="file-item-info">
                                                <div class="file-item-name file-item-base ">文件名</div>
                                                <div class="file-item-time file-item-base ">2020-08-15 12:00:06 1GB
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!--文件列表end-->

                <!--媒体列表-->
                <div class="row">
                    <div class="media-content">
                        <div class="cardBox">
                            <div class="media-img"
                                 style="background-image: url('http://fgsqw.com:8000/files/img.png');"></div>
                        </div>
                        <div class="cardBox">
                            <div class="media-img"
                                 style="background-image: url('http://fgsqw.com:8000/files/img.png');"></div>
                        </div>
                        <div class="cardBox">
                            <div class="media-img"
                                 style="background-image: url('http://fgsqw.com:8000/files/img.png');"></div>
                        </div>
                        <div class="cardBox">
                            <div class="media-img"
                                 style="background-image: url('http://fgsqw.com:8000/files/img.png');"></div>
                        </div>
                        <div class="cardBox">
                            <div class="media-img"
                                 style="background-image: url('http://fgsqw.com:8000/files/img.png');"></div>
                        </div>
                        <div class="cardBox">
                            <div class="media-img"
                                 style="background-image: url('http://fgsqw.com:8000/files/img.png');"></div>
                        </div>
                        <div class="cardBox">
                            <div class="media-img"
                                 style="background-image: url('http://fgsqw.com:8000/files/img.png');"></div>
                        </div>
                        <div class="cardBox">
                            <div class="media-img"
                                 style="background-image: url('http://fgsqw.com:8000/files/img.png');"></div>
                        </div>
                        <div class="cardBox">
                            <div class="media-img"
                                 style="background-image: url('http://fgsqw.com:8000/files/img-slide-1.jpg');"></div>
                        </div>
                        <div class="cardBox">
                            <div class="media-img" style="background-image: url('images/lanshare.png');"></div>
                        </div>

                    </div>
                </div>
                <!--媒体列表end-->

                <!--软件列表-->
                <div class="row">

                </div>
                <!--软件列表end-->
            </div>

        </main>
        <!--主要视图end-->
    </div>
</div>

<script type="text/javascript" src="js/jquery.min.js"></script>
<script type="text/javascript" src="js/bootstrap.min.js"></script>
<script type="text/javascript" src="js/perfect-scrollbar.min.js"></script>
<script type="text/javascript" src="js/main.min.js"></script>

<script type="text/javascript">

    let fastFile = {
        path: "/",
        isFile: false,
        name: "...",
        isDirectory: true
    }

    let files = [fastFile, {
        path: "",
        isFile: false,
        name: "/"
    }]


    function onfile(index) {
        var file = files[index];
        if (file.isFile) {
            return
        }
        $(".filelist").empty();
        $.ajax({
            url: "/files",
            type: "post",
            dataType: "json",
            contentType: "json/application",
            data: JSON.stringify({path: file.path, isBack: index === 0}),
            success: function (result) {
                fastFile.path = result.path;
                $('.path-text').text(result.path);
                files = result.list;
                files.splice(0, 0, fastFile);
                let i = 0;
                // 循环遍历上面的json数据，每一行代表一个li
                files.forEach(function (item, index) {
                    var li;
                    if (item.isDirectory) {
                        li = $("<div class='file-item' onclick=\"onfile(" + index + ")\"></div>");
                    } else {
                        li = $("<div class='file-item' onclick=\"window.location.href='/file/" + item.name + "?path=" + item.path + " ';return false\"></div>");
                    }
                    if (item.isDirectory) {
                        li.append("<div class='file-item-icon file-item-base file-icon-folder'></div>");
                    } else {
                        li.append("<div class='file-item-icon file-item-base file-icon-file'></div>");
                    }
                    var info = $('<div class="file-item-info"></div>');
                    info.append($("<div class='file-item-name'>" + item.name + "</div>"));
                    // li.append($("<td>" + item.name + "</td>"));
                    if (index === 0) {
                        info.append($("<div class='file-item-time file-item-base'></div>"));
                    } else {
                        info.append($("<div class='file-item-time file-item-base'>" + item.time + "</>"));
                    }
                    li.append(info);
                    $(".filelist").append(li);
                    i++
                });
            },
            error: function (result) {
                // alert(result.message)
            }
        });
    }

    onfile(1)


    $(".nav-item-media").click(function () {
        $(".file-list-div").hide();
        $(".media-content").show();
    });

    $(".nav-item-files").click(function () {
        $(".file-list-div").show();
        $(".media-content").hide();
    });


</script>

</body>
</html>